import { useLayoutEffect, useRef } from "react";
import { gsap } from "../../animations/gsap.config";
import Section from "../layout/Section";
import Container from "../ui/Container";
import { certificationData } from "../../data/certification.data";

export default function CertificationSection() {
  const data = certificationData;
  const containerRef = useRef<HTMLDivElement>(null);

  useLayoutEffect(() => {
    const ctx = gsap.context(() => {
      // 1. Animate Header Elements (Badge, Title, Subtitle)
      gsap.from(".animate-header", {
        scrollTrigger: {
          trigger: containerRef.current,
          start: "top 85%",
        },
        y: 30,
        opacity: 0,
        stagger: 0.2,
        duration: 0.8,
        ease: "power2.out",
      });

      // 2. Animate Certificates with a slight scale-up stagger
      gsap.from(".animate-cert", {
        scrollTrigger: {
          trigger: ".cert-wrapper",
          start: "top 90%",
        },
        scale: 0.8,
        opacity: 0,
        stagger: 0.1,
        duration: 0.6,
        ease: "back.out(1.7)",
      });
    }, containerRef);

    return () => ctx.revert();
  }, []);

  // Hover animations for individual certificates
  const onMouseEnter = (e: React.MouseEvent<HTMLImageElement>) => {
    gsap.to(e.currentTarget, { y: -10, scale: 1.05, duration: 0.3 });
  };

  const onMouseLeave = (e: React.MouseEvent<HTMLImageElement>) => {
    gsap.to(e.currentTarget, { y: 0, scale: 1, duration: 0.3 });
  };

  return (
    <Section className="bg-white overflow-hidden">
      <Container>
        <div ref={containerRef}>
          {/* Badge */}
          <div className="animate-header mb-4 text-center">
            <span className="inline-flex items-center gap-2 rounded-full border border-[#C9A14A] bg-[#F8F5D2] px-4 py-2 text-base text-text-primary font-semibold font-ebGaramond">
              <svg
                fill="#C9A14A"
                className="w-6 h-6"
                viewBox="0 0 512 512"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d="M501.982 182.676a7 7 0 0 0-6.184-6.304c-46.403-5.254-81.757-16.564-105.081-33.618a7 7 0 0 0-8.262-.002c-5.616 4.102-11.934 7.868-18.925 11.301l-16.128-12.617c-2.784-2.167-4.317-4.819-4.822-8.317l-6.377-45.438c-1.911-13.639-13.743-23.593-27.562-23.119l-45.783 1.615c-3.579.109-6.463-.938-9.095-3.306l-34.077-30.704a26.855 26.855 0 0 0-35.985.004l-34.069 30.697c-2.634 2.37-5.527 3.417-9.073 3.31l-45.85-1.616C80.944 64.101 69.1 74.041 67.19 87.675l-6.408 45.453c-.487 3.501-2.009 6.142-4.805 8.317l-36.128 28.251c-10.887 8.472-13.578 23.701-6.259 35.427l24.294 38.893c1.886 3.017 2.417 6.024 1.668 9.49l-9.523 44.867a26.775 26.775 0 0 0 17.979 31.135l3.586 1.165-40.806 101.404c-2.178 5.443-1.638 10.735 1.48 14.518 3.053 3.706 8.027 5.216 13.656 4.142l55.691-10.711 35.408 44.241c3.041 3.836 6.965 5.922 11.007 5.922q1.017 0 2.038-.177c4.853-.847 8.712-4.529 10.589-10.107l27.807-82.929 28.423-11.483c3.281-1.331 6.336-1.331 9.627.004l16.403 6.627 29.436 87.761c1.848 5.567 5.686 9.256 10.532 10.121q1.043.185 2.083.185c4.036 0 7.96-2.078 11.006-5.896l35.43-44.267L367.1 450.74c5.618 1.076 10.594-.439 13.648-4.158 3.118-3.796 3.645-9.092 1.45-14.514l-22.159-55.125c7.557 3.949 15.578 7.535 24.077 10.741a7 7 0 0 0 4.942 0c84.688-31.949 122.682-100.923 112.925-205.006zM127.535 474.992l-37.627-47.014a6.99 6.99 0 0 0-6.789-2.5l-59.16 11.378 40.983-101.844 26.706 8.676c3.362 1.083 5.697 3.047 7.362 6.207l21.537 40.467c5.973 11.274 18.86 16.645 30.909 13.292zM230.91 380.25l-19.14-7.733c-6.684-2.712-13.462-2.712-20.137-.004l-42.514 17.175c-6.146 2.475-13.109-.053-16.205-5.895l-21.529-40.454c-3.372-6.398-8.567-10.766-15.426-12.976l-43.633-14.176a12.81 12.81 0 0 1-8.601-14.902l9.519-44.847c1.521-7.034.348-13.711-3.484-19.844l-24.292-38.89c-3.506-5.617-2.225-12.908 2.994-16.969l36.129-28.252c5.683-4.424 9.068-10.289 10.059-17.417l6.407-45.446a12.84 12.84 0 0 1 13.172-11.067l45.861 1.617c7.219.238 13.571-2.092 18.912-6.899l34.067-30.695a12.875 12.875 0 0 1 17.249-.004l34.075 30.702c5.338 4.805 11.704 7.121 18.934 6.896l45.794-1.615c6.632-.208 12.3 4.538 13.215 11.068l6.382 45.467c1.03 7.134 4.422 12.986 10.071 17.383l10.101 7.902c-14.392 5.461-31.025 9.789-49.817 12.957-5.298-12.431-12.852-23.595-22.509-33.251-41.282-41.282-108.453-41.282-149.733-.002-20.01 19.995-31.029 46.584-31.029 74.869s11.02 54.874 31.026 74.866a108 108 0 0 0 6.156 5.695q.298.283.63.531c19.042 16.053 42.887 24.803 68.082 24.803 28.285 0 54.874-11.02 74.868-31.028a109 109 0 0 0 3.982-4.208c5.778 17.026 13.859 32.31 24.229 45.834-4.778 2.099-9.292 5.323-12.785 11.875l-21.519 40.487a12.83 12.83 0 0 1-16.192 5.885l-22.997-9.291a6 6 0 0 0-.372-.15zm44.917-111.014a92 92 0 0 1-7.152 8.574c-7.75-18.12-22.436-32.118-40.419-39.142 10.476-8.015 17.25-20.636 17.25-34.815 0-24.149-19.659-43.795-43.824-43.795s-43.795 19.646-43.795 43.795c0 14.176 6.768 26.795 17.234 34.811-17.98 7.019-32.666 21.01-40.42 39.122-16.064-17.088-24.896-39.276-24.896-62.835 0-24.542 9.562-47.614 26.926-64.966 35.822-35.822 94.109-35.822 129.932 0 7.501 7.501 13.532 16.052 18.012 25.494-2.405.314-4.834.614-7.302.894a7 7 0 0 0-6.183 6.302c-3.031 32.243-1.472 61.113 4.636 86.561zm-74.144-21.56c25.542 0 47.91 16.334 55.858 40.224-15.954 12.274-35.381 18.942-55.844 18.942s-39.906-6.675-55.866-18.961c7.953-23.88 30.316-40.206 55.852-40.206zm-29.792-43.823c0-16.428 13.365-29.792 29.792-29.792s29.821 13.365 29.821 29.792-13.377 29.82-29.821 29.82-29.792-13.377-29.792-29.82M369.03 436.85l-59.129-11.372a7 7 0 0 0-6.789 2.5l-37.628 47.014-25.48-75.966 9.031 3.648a27 27 0 0 0 10.121 1.979c9.673 0 18.9-5.247 23.688-14.283l21.51-40.471c2.202-4.131 4.704-5.368 10.06-7.096q11.405 12.18 25.701 22.115zm17.558-63.218c-13.349-5.212-25.376-11.375-36.105-18.498a7 7 0 0 0-1.578-1.059c-9.888-6.733-18.639-14.306-26.264-22.733a7 7 0 0 0-1.932-2.178c-28.888-33.319-40.757-79.555-36.061-139.56 31.889-4.026 58.788-10.996 80.404-20.802.349-.128.69-.278 1.017-.462 7.486-3.453 14.332-7.25 20.516-11.391 24.158 16.191 58.398 27.161 101.939 32.655 7.341 94.133-26.051 154.389-101.938 184.027zm-10.758-98.543 32.482-32.846a7.003 7.003 0 0 1 9.957 9.847l-37.956 38.381a7 7 0 0 1-10.4-.492l-15.477-18.936a7.002 7.002 0 0 1 10.842-8.862zm85.281-66.782c-27.62-5.115-51.606-12.9-71.292-23.139a7 7 0 0 0-6.458-.001c-19.726 10.247-43.713 18.032-71.294 23.14a7 7 0 0 0-5.727 6.905c.196 64.767 25.471 108.094 77.269 132.457a7 7 0 0 0 5.961-.001c51.764-24.359 77.038-67.685 77.268-132.452a7 7 0 0 0-5.727-6.909m-74.523 125.25c-43.493-21.579-64.632-57.536-66.157-112.606 25.08-5.067 47.294-12.359 66.156-21.718 18.833 9.354 41.046 16.645 66.157 21.717-1.552 55.075-22.69 91.03-66.156 112.607" />
              </svg>{" "}
              {data.badge}
            </span>
          </div>

          {/* Title */}
          <h2 className="animate-header text-center font-anekBangla text-2xl font-bold text-text-dark">
            {data.title}
          </h2>

          <p className="animate-header mx-auto font-anekBangla mt-3 max-w-2xl text-center text-sm text-text-dark">
            {data.subtitle}
          </p>

          {/* Certificates Wrapper */}
          <div className="cert-wrapper mt-14 flex flex-wrap items-center justify-center gap-7">
            {data.certificates.map((cert) => (
              <img
                key={cert.id}
                src={cert.image}
                alt={cert.alt}
                className="animate-cert h-24 object-contain cursor-pointer will-change-transform"
                draggable={false}
                onMouseEnter={onMouseEnter}
                onMouseLeave={onMouseLeave}
              />
            ))}
          </div>
        </div>
      </Container>
    </Section>
  );
}
